@using DCC.COLAB.Common.AuxiliarEntities;
@using DCC.COLAB.Common.Entities;

@{
    Disciplina disciplina = Convert.ChangeType(ViewBag.disciplina, typeof(Disciplina));
    List<Tema> listaTemas = Convert.ChangeType(ViewBag.listaTemas, typeof(List<Tema>));
    List<Prova> listaProvas = Convert.ChangeType(ViewBag.listaProvas, typeof(List<Prova>));
    List<TipoProva> listaTipos = Convert.ChangeType(ViewBag.listaTipos, typeof(List<TipoProva>));
}

<html>
    <body>
        <div>
            <h3>@disciplina.nome</h3>

            <div class="form-group"></div>

            <div class="col-md-6 text-left">
                @if (listaProvas.Count == 0)
                { 
                    <div class="noResults">
                        <h4 style="color:red">Não há provas cadastradas para esta disciplina.</h4>
                    </div>
                }
                else
                {
                    foreach (TipoProva tipo in listaTipos)
                    { 
                        <div class="divTipoProva">
                            <h4>@tipo.nome</h4>
                            <div class="list-group">
                            @for (int i = 0; i < listaProvas.Count; i++)
                            {
                                if (listaProvas[i].tipo.id == tipo.id)
                                { 
                                    <a href="~/Home/Prova/@listaProvas[i].id" class="list-group-item">
                                    @if (listaProvas[i].avaliacao > 0)
                                    {
                                        <span class="badge">
                                        @for (int j = 1; j <= listaProvas[i].avaliacao; j++)
                                        {
                                            <img src="~/Content/img/ministar.png" alt="@j"/>
                                        }
                                        </span>
                                    }
                                    @if (listaProvas[i].recomendadoMonitor)
                                    {
                                        <span class="badge">
                                            <img src="~/Content/img/minimonitor.png" alt="Monitor Recomenda"/>
                                        </span>
                                    }
                                    @if (listaProvas[i].recomendadoProfessor)
                                    {
                                        <span class="badge">
                                            <img src="~/Content/img/miniprofessor.png" alt="Professor Recomenda"/>
                                        </span>
                                    }
                                        @listaProvas[i].turma.periodo.tableString - @listaProvas[i].turma.listaProfessoresString
                                    </a>
                                }
                            }
                            </div>
                        </div>
                    }
                }
            </div>

            <div class="col-md-6 text-center">
                <div>
                    <h4>Temas</h4>
                    <div id="divTemas" class="list-group">
                        <a href="#" class="list-group-item active">
                            <span class="badge">50</span>
                            TODOS
                        </a>
                    @for (int i = 0; i < listaTemas.Count; i++)
                    {
                        <a href="#" class="list-group-item">
                            <span class="badge">14</span>
                            @listaTemas[i].nome
                        </a>
                    }
                    </div>
                </div>
            </div>

        </div>
    </body>
</html>

<script>
    $(document).ready(function () {
        $('.divTipoProva').each(function () {
            var count = $(this).find('.list-group-item').length;
            if (count == 0) {
                $(this).remove();
            }
        });
    });

    $('#divTemas .list-group-item').click(function () {
        $('#divTemas .list-group-item.active').removeClass('active');
        $(this).addClass('active');
    });

</script>